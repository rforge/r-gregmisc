\documentclass{bioinfo}
\copyrightyear{2004}
\pubyear{2004}

\begin{document}
\firstpage{1}

\title{Sample Size Estimation for Microarray Experiments}
\author{
  Peng Liu\,$^{\rm a}$ \t
  and
  Gregory R Warnes\,$^{\rm b}$\footnote{to whom correspondence should
    be addressed}
}
\address{
  $^{\rm a}$Department of Biological Statistics and Computational
  Biology, Cornell University, Ithaca, NY 14853 \\
  $^{\rm b}$Nonclinical Statistics, Pfizer Global Research and Development,
  Groton, CT 06340
}

\maketitle

\begin{abstract}

\section{Motivation:}
Microarray technology is widely applied in biomedical and
pharmaceutical research to detect differences in gene expression
levels between treatment groups.  The high value, and cost, of
experiments employing microarray technologies makes sample size
estimation an important issue.  However, the high dimensionality of
microarray data prevents traditional methods for sample size
calculation from being directly applied.

\section{Method:}
We propose a straightforward method for estimating the sample size
for microarray experiments. First, standard deviations from
existing control data are used to estimate the variability of each
gene. Then, a standard sample size calculation is performed
separately for each gene.  Finally the calculated sample sizes are
summarized through a cumulative plot that displays the tradeoff
between sample size and power.  Scientists can use this
information to select the best sample size for their specific
application.  While we illustrate the method using a two-sample
t-test with pooled variance, it can be easily adapted to any
statistical method for which sample-size calculation can be
performed.

\section{Results:}
We evaluated the performance of this method for 2-sample t-tests
using a simulation study which varied parameters that could affect
the accuracy of the method.  In order to make the simulation as
realistic as possible, we used variance and covariance information
obtained from real data.  Surprisingly, this data data showed very
high interdependency among genes.  While the sample size
estimation method does not explicitly account for these
dependencies, we found that its performance was unaffected by the
level of dependency. We also found that the true proportion of
differentially expressed genes had no effect on the accuracy of
the sample size calculation method.  We did find that the large
differences in variance between treatments and use of alternative
multiple testing procedure can have a large effect on the accuracy
of sample size estimation.  Fortunately, our method can be easily
extended for either or both of these cases.

\section{Availability:}
An R package, \tt{exp.ssize}, implementing the described methods, is
available upon request.

%\section{Contact:} \href{ $^{\rm a}$ $ Gregory_R_Warnes@groton.pfizer.com $ \\
%                          $^{\rm b}$ $PL61@cornell.edu$}
%                          {$ Gregory_R_Warnes@groton.pfizer.com $  \\
%                           $ PL61@cornell.edu $}
\end{abstract}

\section{Introduction}

High-throughput microarray experiment allow the measurement of
expression levels for tens of thousands of genes simultaneously.
These experiments have been used in many disciplines of biological
research, such as neuroscience (\citealp{Mandel03}), pharmacogenomcic
research, genetic disease and cancer diagnosis (\citealp{Heller02}),
etc. As a tool for estimating gene expression and SNP (Single
Nucleotide Polymorphism) genotyping, microarrays produces huge amounts
of data provide new insight into these disciplines.

Microarray experiments are rather costly in terms of both
materials (RNA sample, reagents, chip, etc), laboratory manpower,
and data analysis effort.  As a consequence, many microarray
experiments employ only a small number of replicates (ie, 3 to 4)
(\citealp{Mandel03}). In many cases, this sample size is not
adequate to perform reliable statistical estimation, resulting in
an enormous waste of resources. It is critical, therefore, to
perform proper experimental design, including sample size
estimation, before carrying out the experiment. Since tens of
thousands of variables (gene expressions) are measured on each
single chip, it is essential to take into account multiple testing
and dependency among variables when calculating sample size.
Estimating sample size for large numbers of statistical tests
imposes new questions, including: Should one use one or multiple
value of for power? Should a single value for minimum effect size
be used?  How should error rates be adjusted for multiple-testing?
 Further, traditional methods for sample size calculation apply only to a single hypothesis test
and cannot be directly applied to the microarray problem.

Possible approaches to estimating sample size for microarray
experiments range between two extremes. At one extreme, sample
size estimation can be performed by constructing a model for the
entire system, including the realistic error structures and
interdependencies among variables. Provided that the model is
appropriate, this choice should generate a highly accurate answer.
However, it can take tremendous effort to find an appropriate and
general model, not to mention the possible complexity and
computation needed for the model. As an example of this approach,
Zien et al.  (2002) proposed a hierarchical model including
several different sources of error, including heuristic choices
for the key parameters in the model. Unfortunately, the model
itself is non-identifiable, preventing the direct use of
historical data to provide all of the necessary parameters.  As
the behavior of microarray data from different microarray
technologies and for different biological systems is extremely
varied, the applicability of this model and its heuristic
parameters to a particular problem is uncertain.

At the other extreme, standard sample size calculation methods can
be applied individually to each gene, and a summary can be
constructed to provide an overall estimate of the required sample
size.  With this choice, the calculations are simple to set up,
the results can be obtained quickly, and it is easy to incorporate
available data. Further, such methods are easy to understand and
to explain to applied scientists.  However, this approach might
not capture enough of the structure of the system, leading to
incorrect estimates for sample size.  This is the approach we have
applied, and we describe a simulation study demonstrating that our
method functions well despite its simplicity.

Hwang et al.  (2002) proposed a method that lies between the two
extremes.  This method first identifies differentially expressed
genes and then calculates the power and sample size on a space
reduced by Fisher discriminant analysis. It thus combines the
analysis of data on the current experiment with estimation of
sample size for the next experiment. However, this method does not
apply when preliminary results and knowledge of differentially
expressed genes for the specific question of interest are not
available, limiting the general applicability of this method.

The paper is organized as follows. Section 2 describes our proposed
method in detail. Simulation studies to check the performance of the
method under a variety of conditions are outlined in Section 3.
Section 4 presents our observations and results from the simulation
study.  Section 5 provides discussion of the simulation results and
comparison of our method with other proposed methods.

\section{Method}
To illustrate our method, we assume that a microarrray experiment
is set up to compare gene expressions between one treatment group
and one control group. We further assume that microarray data has
been normalized and transformed so that the data for each gene is
sufficiently close to a normal distribution that a standard
2-sample t-test will reliably detect differentially expressed
genes. The tested hypothesis for each gene is:

\begin{equation}
  H_0: \mu_{T} = \mu_{C}  \nonumber
\end{equation}

versus
\begin{equation}
  H_1: \mu_{T} \neq \mu_{C} \nonumber
\end{equation}
                                %
where $\mu_{T}$ and $\mu_{C}$ are means of gene expressions for treatment and control group respectively.

The proposed procedure to estimate sample size is:

\begin{enumerate}
\item{Estimate standard deviation ($\sigma$) for each gene based on
    \emph{control samples} from existing studies performed on the
    same biological system.}

\item{Specify values for
    \begin{enumerate}
    \item minimum effect size, ($\Delta$) (fold-change)
    \item maximum family-wise type I error rate, ($\alpha$)
    \item desired power, ($1 - \beta$).
    \end{enumerate}
  }

\item{Calculate the per-test Type I error rate necessary to control
    the family-wise error rate (FWER) using the Bonferonni correction:}
\begin{equation}
  \alpha_G = \frac{\alpha}{G}
\end{equation}
%
where $G$ is the number of genes on the microarray chip.

\item{Compute sample size separately for each gene according to the
    standard formula for the two-sample t-test with pooled variance:}
  \begin{eqnarray}
    \lefteqn{1-\beta}
    &=& 1-T_{n1+n2-2} \left( t_{\alpha_G/2,n1+n2-2} | \frac{\Delta}{\sigma \sqrt{\frac{1}{n_1} + \frac{1}{n_2}}}\right) \nonumber \\
    & & +~T_{n1+n2-2} \left( -t_{\alpha_G/2,n1+n2-2} | \frac{\Delta}{\sigma \sqrt{\frac{1}{n_1} + \frac{1}{n_2}}}\right)
    \label{eq:formula}
  \end{eqnarray}
                                %
  where $\mathrm{T}_{d}(\bullet|\theta)$ is the cumulative
  distribution function for non-central t-distribution with $d$ degree
  of freedom and the non-centrality parameter $\theta$.

\item{Summarize the necessary sample size across all genes using a
    cumulative plot of required sample size. An example of such a plot
    is given in Figure \ref{fig:CumPlot}.}

\end{enumerate}

\begin{figure}[h]
  \centerline{\includegraphics*[width=3.2in]{CumPlotF.pdf}}
                                %\centerline{\includegraphics*[width=3.5in]{f3cv.pdf}}
  \caption[Cumulative Plot of Sample Size Calculated for All Genes]
  {After estimation for each gene separately, all estimated sample
    sizes are summarized in this cumulative plot. Sample size can then
    be selected by balancing the number of genes achieving the desired
    power againts the required sample size.}
  \label{fig:CumPlot}
\end{figure}

On the cumulative plot, for the point with x coordinate being $n$,
the y coordinate is the proportion of genes needing sample size
smaller than or equal to $n$. This is the same as the proportion
of genes with power greater than or equal to the specified power
($1- \beta$) at sample size $n$. Hence it allows users to
visualize the relationship between power for all genes and the
sample size in a single plot. Based on user-defined criterion, a
sample size will be picked for microarray experiment. For example,
a sample size of 10 will be chosen if more than $80\%$ of genes
are desired to achieve the power of $80\%$.

The method can be easily adapted to other tests for detecting
differentially expressed genes. For example, if several groups of
treatments are compared using ANOVA, the method will be applied by
substituting t-test  with F-test. Similarly, power for paired
sample formula will replace the one for 2-sample test formula
(\ref{eq:formula}) in paired samples.


\section{Simulation Study}
We carried a simulation study in order to check the performance of the proposed method under violations of assumptions and
influences of some variables that can possibly affect the result. A second goal of the simulation study is to provide a
practical guide table of sample size for different situations, such as the case with a specified proportion of genes that are
interdependent.

There are many variables that may possibly affect the accuracy of sample size estimation. For example, Bonferroni adjustment
assumes independence between tests. However, interdependencies exist among genes such as those regulatory groups. Proportions
of truly differentially expressed genes and other violations of test assumptions such as unequal variance may also have various
influencing effects on accuracy of sample size estimation. The variables that we included in this simulation study are
summarized in Table \ref{tb:SimuVariables}.

\begin{table}[h]\centering
  \caption{Tested Variables in Simulation Study}\ \\
  \begin{tabular}{lcc}
    \hline\hline
    \\
                                % after \\: \hline or \cline{col1-col2} \cline{col3-col4} ...
    Description & Variable & Tested Levels \\
    \\
    \hline\hline
    Proportion of genes & & \\
    that are dependent & $\gamma$ & 100\%, 80\%, 50\%, 0\\
    \hline
    Proportion of genes with & & \\
    true differential expression & $a$ & 100\%, 50\%,
    10\%, 5\% \\
    \hline
    Variance ratio &  &\\
    between two groups & $r$ & 1, 3, 10  \\
    \hline
    Minimum effect size  & &2-fold \\
    for scientific relevance & $\Delta$ & 4-fold \\
    \hline
    Choice of multiple  & & Bonferroni,  \\
    comparison method & m.method & FDR* \\
    \hline\hline
  \end{tabular}
  \emph{*:}FDR indicates the Benjamini and Hochberg procedure to control false discovery rate \label{tb:SimuVariables}
\end{table}

The simulation starts with sampling standard deviation (for genes
that independent) and/or covariance matrices (for groups of
interdependent genes) based on the covariance matrices of a real
data set. The data that we used to get the covariance matrices are
normalized expressions for the control group of an experiment
using Affymetrix U133 chip. Then two separate computations are
performed as outlined in Figure \ref{fig:SimuFC}. One is for
estimation of sample size based on the proposed method and the
other is for calculation of the true sample size needed to achieve
the same power and control the same type I error as in the
estimation.

\begin{figure}[h]
  \centerline{\includegraphics*[width=3.2in]{SimuFC.pdf}}
                                %\centerline{\includegraphics*[width=3.5in]{f3cv.pdf}}
  \caption[Flow Chart for Simulation Study]
  {Simulation study is performed to check the performance of proposed method.
    One set of gene expression sample is generated and calculated for sample size following the steps descried in Method. Many sets of gene expression data are generated and
    tested with standard t-procedure. Test results are pooled to get the true power for
    each sample size. Estimated sample size and simulation results are compared at the end.}
  \label{fig:SimuFC}
\end{figure}

One set of random sample for the control group is generated based on standard deviation and covariance matrices sampled from
the first step. Sample sizes are estimated according to the procedures described in Method. This provides the estimated
cumulative plot for sample size. On the other track, many samples for both control and treatment groups are generated based on
the same sampled standard deviation and covariance matrices. The number of samples to generate are chosen based on the
precision desired for simulation result. With 95\% confidence that the power obtained from simulation result is within a margin
of 2.5\% of true power, at least 983 samples are needed. We generated 985 samples for each simulation for calculating true
power. Standard 2-sample t-test with pooled variance are performed for each sample. Bonferroni adjustment or Benjamini and
Hochberg procedure (\citealp{Benjamini95}) to control False Discovery Rate (FDR) are used to control errors in multiple
testing. Finally, the test results are pooled together to yield the true power for each sample size and each differentially
expressed gene. The cumulative plot based on the true power is compared with the estimated plot.

\section{Results}

\subsection{Observation of high interdependency}
The independence assumption offers a nice property of the data and
allows application of many statistical procedures such as
Bonferroni adjustment for controlling type I error for multiple
test. In checking whether this assumption is acceptable in sample
size estimation, we investigated two real data sets from
Affymetrix experiments. Both data sets are normalized expressions
for an experiment using Affymetrix U133 chip (?). Both revealed
that high dependencies exist for every gene on other genes from
the calculated correlation matrix. For each gene, the highest 50
correlation coefficients in absolute value are selected for one
data set and summarized in the histogram. Figure
\ref{fig:HistCorr} showed that the minimum absolute value of
correlation coefficients is about 0.7. This indicates that each
gene is highly interdependent with at least 50 other genes.

\begin{figure}[h]
  \centerline{\includegraphics*[width= 2.75 in]{HistCorr.pdf}}
                                %\centerline{\includegraphics*[width=3.5in]{f3cv.pdf}}
  \caption[Histogram of Correlation Coefficients among Genes]
  {Histogram of Correlation Coefficients among Genes for the control group of one Affymetrix
    experiment. The top 50 correlation coefficients in absolute value are selected and included in the plot.}
  \label{fig:HistCorr}
\end{figure}

\subsection{Simulation Results}

\subsubsection{Dependency}

Figure \ref{fig:ResDep} compared estimation of sample size based
on proposed method and results from simulation for different
proportions of genes that are interdependent ($\gamma$). We
presented the result for the two extreme cases: that all genes are
independent of each other (panel (a)) and that 100\% of genes come
from interdependent groups (panel (b)). The other parameters for
generating the two panels are the same: $a = 1, r = 1, \Delta = 2$
-fold change and Bonferroni adjustment is used for multiple
testing. For both cases, estimated sample size curve overlapped
with true results from simulation. This showed that dependencies
among genes has no effect on sample size estimation for our
method. The other tested levels, $\gamma$ =80\% and $\gamma$ =
50\%, showed the same result. Considering all genes are dependent
on others, this is a assuring result which allows the assumption
of independence in sample size calculation.

\begin{figure}[h]
  \centerline{\includegraphics*[width=3.5in]{ResDepF.pdf}}
                                %\centerline{\includegraphics*[width=3.5in]{f3cv.pdf}}
  \caption[Effect of interdependency of genes on sample size estimation]
  {Effect of interdependency of genes on sample size estimation.
    Cumulative plots for sample sizes from both estimation and simulation result
    are generated for the following variable values: $a = 1, r = 1, \Delta = 2$ -fold change
    and Bonferroni adjustment for multiple testing control. Dash lines are for estimated sample sizes
    while solid black lines are for sample sizes obtained from simulation result.}
  \label{fig:ResDep}
\end{figure}

\subsubsection{Proportions of Genes with True Differential Expression}
The proportion of genes with true differential expression may vary
a lot for different treatments. To get a conservative estimate of
sample size and for general purpose, we suggest using all the
genes for calculating cumulative plot unless information is
available for how many genes may be truly differentially
expressed. In the latter case, a "focus" list of genes can be used
instead. We tested four different levels for proportion of genes
with true differential expression, $a = 100\%, 50\%, 10\%$ and
$5\%$. None of the tested levels showed any effect on sample size
estimation, i.e., the estimated sample size curve overlapped with
true result from simulation for all tested levels (Figure
\ref{fig:ResAlt}).

\begin{figure}[h]
  \centerline{\includegraphics*[width=3.5in]{ResAlt.pdf}}
                                %\centerline{\includegraphics*[width=3.5in]{f3cv.pdf}}
  \caption[Effect of proportions of genes with true differential expression on sample size estimation]
  {Effect of proportions of genes with true differential expression on sample size estimation.
    Cumulative plots for sample sizes from both estimation and simulation result
    are generated for the following variable values: $\gamma = 1, r = 1, \Delta = 2$ -fold change
    and Bonferroni adjustment for multiple testing control. Dash lines are for estimated sample sizes
    while solid black lines are for sample sizes obtained from simulation result.}
  \label{fig:ResAlt}
\end{figure}

\subsubsection{Var.ratio}

One of the assumptions for using formula (\ref{eq:formula}) is
equal variance for the two groups. Here we checked how well the
estimation is when the variance ratio between two groups is 1, 3
or 10. when variance ratio is 1, the equal variance assumption is
satisfied and the estimation of sample size agreed with the true
sample size very well. When the variance ratio becomes bigger than
one, the difference between estimation and simulation becomes
larger (Figure \ref{fig:ResVar}). Variance ratio smaller than one
is equivalent due to the symmetry of the test procedure. This
indicates weak robustness of  formula (\ref{eq:formula}) against
unequal variance. When there is knowledge that variance ratio is
greater than 3 or smaller than 1/3, other tests such as t-test
with unpooled variance or other appropriate tests are recommended
and corresponding formula should be replace for formula
(\ref{eq:formula}) for sample size calculation. Nonetheless, the
main idea is still applicable.

\begin{figure}[h]
  \centerline{\includegraphics*[width=3.5in]{ResVarF.pdf}}
                                %\centerline{\includegraphics*[width=3.5in]{f3cv.pdf}}
  \caption[Effect of variance ratio between treatment groups on sample size estimation]
  {Effect of variance ratio between treatment groups on sample size estimation.
    Cumulative plots for sample sizes from both estimation and simulation
    results are generated for the following variable values: $\gamma = 1, a = 1, \Delta = 2$ -fold change
    and Bonferroni adjustment for multiple testing control. Dash lines are for estimated sample sizes
    while solid black lines are for sample sizes obtained from simulation result.}
  \label{fig:ResVar}
\end{figure}

\subsubsection{Minimum effect Size ($\Delta$)}

When the minimum effect size ($\Delta$) gets larger, the genes that are truly differentially expressed are easier to be
detected, and the sample size needed is smaller.  With at least 80\% genes to achieve 80\% power, to effect $\Delta = 2$ -fold
change needs sample size of 6, while to effect $\Delta = 4$ -fold change needs sample size of 4 with all other parameters in
simulation the same: $\gamma = 1, a = 1$, variance ratio = 1 and using Bonferroni method to control type I error multiple
testing. With regard to the effect on sample size calculation, $\Delta$ has no effect since the values of $\Delta$ is included
in the formula \ref{eq:formula} and sample sizes were calculated accordingly.

\subsubsection{Multiple Comparison Method}

Many different methods have been proposed for control family wise error rate for multiple testing such as controlling false
discovery rate (FDR) (\citealp{Benjamini95}) and postive FDR (pFDR) (\citealp{Storey00}). Both FDR and pFDR controlling
procedures are supposed to achieve larger power than Bonferroni adjustment due to the more conservativeness for the latter
method. Since Bonferroni adjustment is very straightforward to apply, we choose it as part of our proposed method for sample
size estimation. In the simulation study, we compared the estimated sample size and the true sample size needed when
controlling FDR with Benjamini and Hochberg procedure (\citealp{Benjamini95}). Figure \ref{fig:ResMtd} showed that the true
sample sizes needed for FDR method is much smaller than the estimated sample size with Bonferroni adjustment.

\begin{figure}[h]
  \centerline{\includegraphics*[width=3.5 in]{ResMtd.pdf}}
                                %\centerline{\includegraphics*[width=3.5in]{f3cv.pdf}}
  \caption[Effect of multiple comparison method on sample size estimation]
  {Effect of multiple comparison method on sample size estimation.
    Cumulative plots for sample sizes from both estimation and
    simulation result are generated for the following variable values: $\gamma = 1, a = 1, r = 1,
    \Delta = 2$ -fold change. Dash lines are for estimated sample sizes
    while solid black lines are for sample sizes obtained from simulation result.}
  \label{fig:ResMtd}
\end{figure}


\subsection{Sample Size Guide Table}

One of the goals of the simulation study was to provide sample
size guide table for different situations that we tested.
Biologists can refer to the table and find the number of chips
they need for their specific microarray experiment. With the data
we used for the simulation, the sample size guide table is listed
here, Table \ref{tb:Guidea} and Table \ref{tb:Guideb}. Please note
that the values for sample size depends on the standard deviations
for the data set.

\begin{table}\centering
  \caption{proposition of genes with 80\% desired power}\
  \begin{tabular}{ccccc} \hline
    &Prop'n&of genes& w/ true & diff. expres'n\\
    Var. ratio (r) & 100\% & 50\% & 10\% & 5\%\\
    \hline
    1 & 5.93 & 6.12 & 5.97 & 5.68\\
    3 & 7.87 & 8.15 & 7.95 & 7.55\\
    10 & 13.76 & 14.5 & 14.27 & 12.2\\
    \hline
  \end{tabular}
  \label{tb:Guidea}
  \\
  \caption{proposition of genes with 90\% desired power}\
  \begin{tabular}{ccccc} \hline
    &Prop'n&of genes& w/ true & diff. expres'n\\
    Var. ratio (r) & 100\% & 50\% & 10\% & 5\%\\
    \hline
    1 & 6.6 & 7.93 & 6.54 & 6.44\\
    3 & 8.09 & 10.82 & 8.90 & 8.62\\
    10 & 18.2 & 18.7 & 17.7 & 17.4\\
    \hline
  \end{tabular}
  \label{tb:Guideb}
\end{table}




\section{Discussions}

The number of chips included in microarray experiments directly
affects the reliability of any conclusions of data analysis. It is
critical to have a guideline to select a sample size of chips to
obtain reliable data without wasting money and time. Traditional
methods for calculating sample size can not be directly applied.
The increasing application of microarray experiments calls for a
good method to estimate sample size in designing the experiment
with minimum effort.

There are several proposed methods for sample size calculation of
microarray experiments. None of those are as straightforward as
this one (quote, need to be changed). Hwang et al. (2002) proposed
a method that performs the test to identify differentially
expressed genes first and then calculate the power and sample size
on a reduced parameter space. Dow studied relationship between
minimum detecting size and sample size for a specific experiment
(2003). Both methods cannot be applied to cases where preliminary
results and knowledge of differentially expressed genes are not
available. Zien et al. (2002) proposed a more structured model. We
find the model is not identifiable (****). Here we proposed a very
straightforward method that is easy to apply and flexible to adapt
to different statistical tests to effect differentially expressed
genes. With a cumulative plot that summarizes the sample size
needed for all genes, our proposed method allows separate
calculation of sample size for each gene. Therefore, traditional
standard method to calculate sample size for a single test can be
utilized in the estimation of each individual gene.

We performed a simulation study to check the performance of the
proposed method. Among the variables tested in the simulation
(Table \ref{tb:SimuVariables}), the proportion of genes that are
dependent ($\gamma$) and the proportion of genes with true
differential expression ($a$) have little effect. This is good
news since we observed that the microarray data we tested is
highly interdependent (Figure \ref{fig:HistCorr}). Variance ratio
has a large effect on tested procedure due to the assumption of
equal variance for 2-sample test that we employed. In the cases
when it is known that variance ratio is large, we suggest to use
un-pooled variance to do t-test. Sample size is calculated
accordingly for each gene and the idea of our method still
applies.

For all cumulative plots, we found that there is a steep increase when increasing sample size at small numbers. For example,
Figure \ref{fig:ResDep} showed that increase of sample size from 4 to 5 assures 40\% more genes with desired power (from 22\%
to 64\%). Another increase of one chip (sample size = 6) gets about 80\% genes with desired power. Taking this into account, an
ideal sample size might be the number on the top of the steep part of the curve and on the left of the flat part of the curve.

We found that Bejamini and Hochberg procedure to control FDR has much more power than Bonferroni adjustment (Figre
\ref{fig:ResMtd}). The method can be adjusted to control FDR instead of using the conservative Bonferroni adjustment. Yang
\textit{et al.} (2003) proposed an individual type I error to control to guarantee an FDR, which requires an initial guess of
how many genes will be accepted ($n_0$). This can be used to modify our method to provide a better estimate, especially when
the following statistical tests utilize FDR controlling.


\section*{Acknowledgement}
This work was supported by Pfizer Global Research and Development.

\begin{thebibliography}{}

\bibitem[Benjamini and Hochberg, 1995]{Benjamini95} Benjamini, Y. and Hochberg, Y. (1995)
  Controlling the false discovery rate: a practical and powerful
  approach to multiple testing, {\it Journal of Royal Statistical
    Society B}, {\bf 57:1}, 289-300.

\bibitem[Dow, 2003]{Dow0303} Dow,G.S. (2003) Effect of sample size and p-value filtering techniques on the detection of transcriptional changes induced in
  rat neuroblastoma (NG108) cells by mefloquine, {\it Malaria Journal}, {\bf 2}, 4.

\bibitem[Heller, 2002]{Heller02} Heller, M. J. (2002) {DNA microarray technology: devices, systems, and applications},
  {\it Annual Review in Biomedical Engineering}, {\bf 4}, 129-153.

\bibitem[Hwang {\it et~al}., 2002]{Hwang02} Hwang,D., Schmitt, W. A., Stephanopoulos, G., Stephanopoulos, G. (2002)
  Determination of minimum sample size and discriminatory expression patterns in microarray data,
  {\it Bioinformatics}, {\bf 18:9}, 1184-1193.

\bibitem[Mandel {\it et~al}., 2003]{Mandel03} Mandel, S.,  Weinreb, O., Youdim, M. B. H. (2003)
  Using cDNA microarray to assess Parkinson's disease models and
  the effects of neuroprotective drugs, {\it TRENDS in Pharmacological Sciences}, {\bf 24:4}, 184-191.

\bibitem[Storey, 2002]{Storey02} Storey, J., (2002)
  A direct approach to false discovery rates, {\it Journal of Royal Statistical Society B}, {\bf 64:3}, 479-498.

\bibitem[Yang {\it et~al.}, 2003]{Yang03} Yang, M. C. K., Yang, J. J., McIndoe, R. A., She, J. X. (2003)
  Microarray experimental design: power and sample size considerations, {\it Physiological Genomics}, {\bf 16}, 24-28.
\end{thebibliography}
\end{document}
